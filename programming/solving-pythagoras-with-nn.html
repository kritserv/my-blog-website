<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE-edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="static/css/main.css">
		<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ¦œ</text></svg>">
	<title>Solving Pythagorasâ€™ Theorem with Neural Networks</title>
</head>
<body>
	<nav>
		<div class="nav-content">
			<h1 id="nav-brand"><a href="/" id="nav-button">Krit-Blog</a></h1>
			<h2 id="nav-item"><a href="/" id="nav-button">Home</a></h2>
			<h2 id="nav-item"><a href="/content" id="nav-button">Content</a></h2>
		</div>
	</nav>
	<div class="content">
		<div class="card-content">
			<p>19 Dec 2023</p>
			<h1>Solving Pythagorasâ€™ Theorem with Neural Networks</h1>
			<p>&#8195;&#8195;In this blog, weâ€™ll explore how to use a neural network to solve Pythagorasâ€™ theorem in real-time in your terminal. This is a great example of how machine learning can be applied to solve real world problems for beginner by using mathematical problems. Letâ€™s break down the Python code and understand each part of it.</p>
			<br>
			<img id="big-img" src="static/img/nn-learn-pythagoras.webp">
			<br>			
			<h2>Importing Libraries</h2>
			<div class="code">
			<p><span id="ðŸŸ¨">import</span><span id="â¬œ"> numpy </span><span id="ðŸŸ¨">as</span><span id="â¬œ"> np</span></p>
			<p><span id="ðŸŸ¨">from</span> <span id="â¬œ">tensorflow</span> <span id="ðŸŸ¨">import</span> <span id="â¬œ">keras</span></p>
			<p><span id="ðŸŸ¨">import</span> <span id="â¬œ">os</span></p>
			<p><span id="ðŸŸ¨">import</span> <span id="â¬œ">time</span></p>
			</div>
			<br>
			<p>&#8195;&#8195;The first step is to import the necessary libraries. numpy is used for numerical computations, tensorflow.keras is used for building and training the neural network, and os and time are used for handling system-level operations, and since we're going to see how neural network works in our terminal, time library will be used as delay and os library will be used to clear terminal.</p>
			<br>
			<h2>Generating Data for Training</h2>
			<div class="code">
				<p><span id="â¬œ">A</span> <span id="ðŸŸ¥">=</span> <span id="â¬œ">np</span><span id="ðŸŸ¥">.</span><span id="â¬œ">random</span><span id="ðŸŸ¥">.</span><span id="â¬œ">rand</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ©">10000</span><span id="ðŸŸ¦">)</span> <span id="ðŸŸ¥">*</span> <span id="ðŸŸ©">1000</span></p>
				<p><span id="â¬œ">B</span> <span id="ðŸŸ¥">=</span> <span id="â¬œ">np</span><span id="ðŸŸ¥">.</span><span id="â¬œ">random</span><span id="ðŸŸ¥">.</span><span id="â¬œ">rand</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ©">10000</span><span id="ðŸŸ¦">)</span> <span id="ðŸŸ¥">*</span> <span id="ðŸŸ©">1000</span></p>
				<p><span id="â¬œ">C</span> <span id="ðŸŸ¥">=</span> <span id="â¬œ">np</span><span id="ðŸŸ¥">.</span><span id="â¬œ">sqrt</span><span id="ðŸŸ¦">(</span><span id="â¬œ">A</span><span id="ðŸŸ¥">**</span><span id="ðŸŸ©">2</span> <span id="ðŸŸ¥">+</span> <span id="â¬œ">B</span><span id="ðŸŸ¥">**</span><span id="ðŸŸ©">2</span><span id="ðŸŸ¦">)</span></p>
			</div>
			<br>
			<p>&#8195;&#8195;Here, we generate random data for the sides of the triangle (A and B) and calculate the hypotenuse C using Pythagorasâ€™ theorem. This data will be used to train our neural network.</p>
			<br>			
			<h2>Defining the Model</h2>
			<div class="code">
				<p><span id="â¬œ">model</span> <span id="ðŸŸ¥">=</span> <span id="â¬œ">keras</span><span id="ðŸŸ¥">.</span><span id="â¬œ">model</span><span id="ðŸŸ¥">.</span><span id="â¬œ">Sequential</span><span id="ðŸŸ¦">([</span></p>
				<p>&#8195;<span id="â¬œ">keras</span><span id="ðŸŸ¥">.</span><span id="â¬œ">layers</span><span id="ðŸŸ¥">.</span><span id="â¬œ">Dense</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ©">64</span><span id="ðŸŸ¥">,</span> <span id="â¬œ">activation</span><span id="ðŸŸ¥">=</span><span id="ðŸŸ§">"relu"</span><span id="ðŸŸ¥">,</span> <span id="â¬œ">input_shape</span><span id="ðŸŸ¥">=</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ©">2</span><span id="â¬œ">,</span><span id="ðŸŸ¦">))</span><span id="â¬œ">,</span></p>
				<p>&#8195;<span id="â¬œ">keras</span><span id="ðŸŸ¥">.</span><span id="â¬œ">layers</span><span id="ðŸŸ¥">.</span><span id="â¬œ">Dense</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ©">64</span><span id="ðŸŸ¥">,</span> <span id="â¬œ">activation</span><span id="ðŸŸ¥">=</span><span id="ðŸŸ§">"relu"</span><span id="ðŸŸ¦">)</span>,</p>
				<p>&#8195;<span id="â¬œ">keras</span><span id="ðŸŸ¥">.</span><span id="â¬œ">layers</span><span id="ðŸŸ¥">.</span><span id="â¬œ">Dense</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ©">1</span><span id="ðŸŸ¦">)</span></p>
				<p><span id="ðŸŸ¦">])</span></p>
			</div>
			<br>
			<p>&#8195;&#8195;We define a simple neural network model with two hidden layers, each with 64 neurons. The relu activation function is used in the hidden layers. The output layer has one neuron because we want to predict a single value (the hypotenuse).</p>
			<br>		
			<h2>Compiling the Model</h2>
			<div class="code">
				<p><span id="â¬œ">model</span><span id="ðŸŸ¥">.compile</span><span id="ðŸŸ¦">(</span><span id="â¬œ">optimizer</span><span id="ðŸŸ¥">=</span><span id="ðŸŸ§">"adam"</span><span id="â¬œ">, loss</span><span id="ðŸŸ¥">=</span><span id="ðŸŸ§">"mse"</span><span id="ðŸŸ¦">)</span></p>
			</div>
			<br>
			<p>&#8195;&#8195;The model is compiled with the adam optimizer and the mean squared error (mse) loss function. The optimizer adjusts the weights of the network to minimize the loss, and the loss function measures the difference between the networkâ€™s predictions and the actual values.</p>
			<br>
			<h2>Defining the Callback</h2>
			<div class="code">
				<p><span id="ðŸŸ¨">class</span> <span id="â¬œ">ClearAndPrintC</span><span id="ðŸŸ¦">(</span><span id="â¬œ">keras</span><span id="ðŸŸ¥">.</span><span id="â¬œ">callbacks</span><span id="ðŸŸ¥">.</span><span id="â¬œ">Callback</span><span id="ðŸŸ¦">)</span><span id="ðŸŸ¥">:</span></p>
				<p>&#8195;&#8195;<span id="ðŸŸ¨">def</span> <span id="ðŸŸ¥">on_epoch_end</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ©">self</span><span id="ðŸŸ¥">,</span> <span id="â¬œ">epoch</span><span id="ðŸŸ¥">,</span> <span id="â¬œ">logs</span><span id="ðŸŸ¥">=</span><span id="ðŸŸ©">None</span><span id="ðŸŸ¦">)</span><span id="ðŸŸ¥">:</span></p>
				<p>&#8195;&#8195;&#8195;<span id="â¬œ">time</span><span id="ðŸŸ¥">.</span><span id="â¬œ">sleep</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ©">0.5</span><span id="ðŸŸ¦">)</span></p>
				<p>&#8195;&#8195;&#8195;<span id="ðŸŸ¨">if</span> <span id="â¬œ">os</span><span id="ðŸŸ¥">.</span><span id="â¬œ">name</span> <span id="ðŸŸ¥">==</span> <span id="ðŸŸ§">"nt"</span><span id="ðŸŸ¥">:</span></p>
				<p>&#8195;&#8195;&#8195;&#8195;&#8195;<span id="â¬œ">os</span><span id="ðŸŸ¥">.</span><span id="â¬œ">system</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ§">"cls"</span><span id="ðŸŸ¦">)</span></p>
				<p>	&#8195;&#8195;&#8195;<span id="ðŸŸ¨">else</span><span id="ðŸŸ¥">:</span></p>
				<p>	&#8195;&#8195;&#8195;&#8195;&#8195;<span id="â¬œ">os</span><span id="ðŸŸ¥">.</span><span id="â¬œ">system</span><span id="ðŸŸ¦">(</span><span id="ðŸŸ§">"clear"</span><span id="ðŸŸ¦">)</span></p>
				<p>&#8195;&#8195;&#8195;<span id="â¬œ">pred</span> <span id="ðŸŸ¥">=</span> <span id="â¬œ">model</span><span id="ðŸŸ¥">.</span><span id="â¬œ">predict</span><span id="ðŸŸ¦">([[</span><span id="ðŸŸ©">4</span><span id="ðŸŸ¥">,</span> <span id="ðŸŸ©">3</span><span id="ðŸŸ¦">]])[</span><span id="ðŸŸ©">0</span><span id="ðŸŸ¦">][</span><span id="ðŸŸ©">0</span><span id="ðŸŸ¦">]</span></p>
				<p>&#8195;&#8195;&#8195;<span id="ðŸŸ¥">print</span><span id="ðŸŸ¦">(</span><span id="â¬œ">f</span><span id="ðŸŸ§">'''</span></p>
				<p><span id="ðŸŸ§">Epoch {epoch}</span></p>
				<p><span id="ðŸŸ§">&#8195;&#8195;&#8195;|\\</span></p>
				<p><span id="ðŸŸ§">&#8195;&#8195;&#8195;|&#8195; \\ C={format(pred, ".6f")}</span></p>
				<p><span id="ðŸŸ§">&#8195;&#8195;&#8195;|&#8195;&#8195;\\</span></p>
				<p><span id="ðŸŸ§">A=4&#8195;|&#8195;&#8195;&#8195;\\</span></p>
				<p><span id="ðŸŸ§">&#8195;&#8195;&#8195;| ________\\</span></p>
				<p><span id="ðŸŸ§">&#8195;&#8195;&#8195;&#8195;B=3</span></p>
				<p><span id="ðŸŸ§">&#8195;&#8195;&#8195;'''</span><span id="ðŸŸ¦">)</span></p>
			</div>
			<br>
			<p>&#8195;&#8195;This is a custom callback that clears the terminal and prints the predicted value of C after each training epoch. This allows us to see the modelâ€™s progress in real-time.</p>
			<br>
			<h2>Traning The Model</h2>
			<div class="code">
				<p><span id="â¬œ">model</span><span id="ðŸŸ¥">.</span><span id="â¬œ">fit</span><span id="ðŸŸ¦">(</span><span id="â¬œ">np</span><span id="ðŸŸ¥">.</span><span id="â¬œ">column_stack</span><span id="ðŸŸ¦">((</span><span id="â¬œ">A</span><span id="ðŸŸ¥">,</span> <span id="â¬œ">B</span><span id="ðŸŸ¦">))</span><span id="ðŸŸ¥">,</span> <span id="â¬œ">C</span><span id="ðŸŸ¥">,</span> <span id="â¬œ">epochs</span><span id="ðŸŸ¥">=</span><span id="ðŸŸ©">50</span><span id="ðŸŸ¥">,</span> <span id="â¬œ">callbacks</span><span id="ðŸŸ¥">=</span><span id="ðŸŸ¦">[</span><span id="â¬œ">ClearAndPrintC</span><span id="ðŸŸ¦">()])</span></p>
			</div>
			<br>
			<p>&#8195;&#8195;Finally, the model is trained using the generated data. The fit method is called with the inputs (A and B) and the target values Â©. The model is trained for 50 epochs, and our custom callback is passed to visualize the training process.</p>

			<img id="big-img" src="static/img/nn-learn-pythagoras.webp" >
					
			<h2>Conclusion</h2>
			<p>&#8195;&#8195;This example demonstrates how a neural network can learn to solve Pythagorasâ€™ theorem. The same principles can be applied to real-world data. For instance, a similar network could be trained to predict house prices based on features like the number of rooms and the size of the house. The key is to prepare the data correctly and choose an appropriate network architecture for the task at hand.</p>
		</div>
		<br>
		<p>Full code can be find here: <a target="blank" href="https://github.com/kritserv/neural-network-solve-pythagoras"> github.com/kritserv/neural-network-solve-pythagoras</a></p>
	</div>
</body>
</html>
